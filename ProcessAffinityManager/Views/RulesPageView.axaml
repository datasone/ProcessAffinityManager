<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ProcessAffinityManager.ViewModels"
             x:Class="ProcessAffinityManager.Views.RulesPageView"
             x:DataType="vm:RulesPageViewModel">

    <UserControl.Resources>
        <StreamGeometry x:Key="add_regular">M14.5,13 L14.5,3.75378577 C14.5,3.33978577 14.164,3.00378577 13.75,3.00378577 C13.336,3.00378577 13,3.33978577 13,3.75378577 L13,13 L3.75387573,13 C3.33987573,13 3.00387573,13.336 3.00387573,13.75 C3.00387573,14.164 3.33987573,14.5 3.75387573,14.5 L13,14.5 L13,23.7523651 C13,24.1663651 13.336,24.5023651 13.75,24.5023651 C14.164,24.5023651 14.5,24.1663651 14.5,23.7523651 L14.5,14.5 L23.7498262,14.5030754 C24.1638262,14.5030754 24.4998262,14.1670754 24.4998262,13.7530754 C24.4998262,13.3390754 24.1638262,13.0030754 23.7498262,13.0030754 L14.5,13 Z</StreamGeometry>
        <StreamGeometry x:Key="arrow_up_regular">M4.21157,12.7326 C3.9244,13.0312 3.93361,13.5059 4.23213,13.7931 C4.53064,14.0803 5.00543,14.0711 5.29259,13.7725 L13.2521,5.49831 L13.2521,24.2511 C13.2521,24.6653 13.5879,25.0011 14.0021,25.0011 C14.4163,25.0011 14.7521,24.6653 14.7521,24.2511 L14.7521,5.4993 L22.7106,13.7725 C22.9978,14.0711 23.4726,14.0803 23.7711,13.7931 C24.0696,13.5059 24.0788,13.0312 23.7916,12.7326 L14.7223,3.30466 C14.3289,2.89568 13.6743,2.89568 13.2809,3.30466 L4.21157,12.7326 Z</StreamGeometry>
        <StreamGeometry x:Key="arrow_down_regular">M23.7916,15.2664 C24.0788,14.9679 24.0696,14.4931 23.7711,14.206 C23.4726,13.9188 22.9978,13.928 22.7106,14.2265 L14.7511,22.5007 L14.7511,3.74792 C14.7511,3.33371 14.4153,2.99792 14.0011,2.99792 C13.5869,2.99792 13.2511,3.33371 13.2511,3.74793 L13.2511,22.4998 L5.29259,14.2265 C5.00543,13.928 4.53064,13.9188 4.23213,14.206 C3.93361,14.4931 3.9244,14.9679 4.21157,15.2664 L13.2809,24.6944 C13.6743,25.1034 14.3289,25.1034 14.7223,24.6944 L23.7916,15.2664 Z</StreamGeometry>
    </UserControl.Resources>
    
    <StackPanel Spacing="15" Margin="20 40 20 20">
        <StackPanel Spacing="30" Orientation="Horizontal" Margin="0 0 0 20">
            <TextBlock Text="Rules" FontSize="28" FontWeight="Bold" />

            <Button Command="{Binding AddRuleCommand}">
                <StackPanel Spacing="15" Orientation="Horizontal">
                    <PathIcon Data="{StaticResource add_regular}" />
                    <TextBlock Text="Add New Rule" />
                </StackPanel>
            </Button>
        </StackPanel>

        <!-- Instruction Text -->
        <TextBlock Text="Rules are matched from top to bottom."
                   Foreground="Gray" FontStyle="Italic" />

        <!-- List of Rules -->
        <ListBox ItemsSource="{Binding RuleVMs}">
            <ListBox.ItemTemplate>
                <DataTemplate DataType="{x:Type vm:RuleViewModel}">
                    <Grid ColumnDefinitions="*,Auto" Margin="0 5 0 5">
                        <!-- Rule Details -->
                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                            <TextBlock FontWeight="SemiBold">
                                <Run Text="{Binding RuleType, StringFormat='{}{0}: '}" />
                                <Run Text="{Binding Criteria}" />
                            </TextBlock>
                            <TextBlock Text="{Binding ProfileName, StringFormat='Applies Profile: {0}'}" FontSize="12" />
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5">
                            <Button Command="{Binding $parent[ListBox].DataContext.MoveUpCommand}"
                                    CommandParameter="{Binding .}"
                                    IsEnabled="{Binding CanMoveUp}"
                                    ToolTip.Tip="Increase Priority">
                                <PathIcon Data="{StaticResource arrow_up_regular}" />
                            </Button>
                            <Button Command="{Binding $parent[ListBox].DataContext.MoveDownCommand}"
                                    CommandParameter="{Binding .}"
                                    IsEnabled="{Binding CanMoveDown}"
                                    ToolTip.Tip="Decrease Priority">
                                <PathIcon Data="{StaticResource arrow_down_regular}" />
                            </Button>
                            <Button Content="Edit" Command="{Binding $parent[ListBox].DataContext.EditRuleCommand}"
                                    CommandParameter="{Binding .}" />
                            <Button Content="Remove" Command="{Binding $parent[ListBox].DataContext.RemoveRuleCommand}"
                                    CommandParameter="{Binding .}" />
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </StackPanel>
</UserControl>